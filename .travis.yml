language: go
go: 
 - "1.12"
sudo: true

script:
 - export GO111MODULE=on
 - make clean
 - make build-deps
 - make deps
 - make generate
 - make test
 - make build

addons:
  apt:
    packages:
      - dos2unix

deploy:
  provider: script
  script: /bin/bash $TRAVIS_BUILD_DIR/release.sh
  skip_cleanup: true
  on:
    tags: true
branch: master